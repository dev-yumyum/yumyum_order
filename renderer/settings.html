<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>설정 - YumYum 주문 관리</title>
    <link rel="stylesheet" href="settings.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="settings-container">
        <!-- 상단 헤더 -->
        <header class="settings-header">
            <div class="header-left">
                <button class="back-btn" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i>
                    <span>이전</span>
                </button>
            </div>
            <div class="header-center">
                <h1>설정</h1>
            </div>
            <div class="header-right">
                <span class="current-time" id="currentTime">02. 29 (금) 00:00</span>
            </div>
        </header>

        <div class="settings-main">
            <!-- 왼쪽 사이드바 메뉴 -->
            <aside class="settings-sidebar">
                <nav class="settings-nav">
                    <button class="nav-item active" data-tab="general" onclick="switchSettingsTab('general')">
                        <i class="fas fa-cog"></i>
                        <span>운영 설정</span>
                    </button>
                    <button class="nav-item" data-tab="printer" onclick="switchSettingsTab('printer')">
                        <i class="fas fa-print"></i>
                        <span>프린터 설정</span>
                    </button>
                    <button class="nav-item" data-tab="notification" onclick="switchSettingsTab('notification')">
                        <i class="fas fa-bell"></i>
                        <span>알림 설정</span>
                    </button>
                </nav>
            </aside>

            <!-- 메인 설정 영역 -->
            <main class="settings-content">
                <!-- 운영 설정 -->
                <div id="general-settings" class="settings-panel active">
                    <div class="settings-two-column">
                        <!-- 왼쪽 컬럼 -->
                        <div class="settings-column-left">
                    <div class="settings-section">
                        <div class="setting-item">
                            <div class="setting-info">
                                        <h3>자동 로그인</h3>
                                        <p>실행 시 자동으로 로그인 되어 주문을 받을 수 있습니다.</p>
                            </div>
                            <label class="toggle-switch">
                                        <input type="checkbox" id="autoLoginEnabled">
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                        <h3>자동 영업 임시중지 설정 <i class="fas fa-info-circle"></i></h3>
                                        <p>주문취소가 반복되면 자동으로 영업을 임시중지합니다.</p>
                            </div>
                            <label class="toggle-switch">
                                        <input type="checkbox" id="autoPauseEnabled" checked>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                        <h3>원산지 출력</h3>
                                        <p>가게별로 등록된 원산지를 주문전표(고객용)에 함께 출력합니다.</p>
                            </div>
                            <label class="toggle-switch">
                                        <input type="checkbox" id="originPrintEnabled">
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="setting-item clickable" onclick="openDeviceManagement()">
                            <div class="setting-info">
                                <h3>기기 관리</h3>
                                        <p>아이디로 얌얌픽업 주문접수에 로그인한 기기를 확인할 수 있습니다.</p>
                            </div>
                                    <button class="btn-secondary">기기조회</button>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                        <h3>프로그램 버전 정보</h3>
                                <p>버전: v1.0.0</p>
                                    </div>
                                    <button class="btn-secondary" onclick="checkUpdate()">버전 확인</button>
                                </div>
                            </div>
                        </div>

                        <!-- 오른쪽 컬럼 -->
                        <div class="settings-column-right">
                            <div class="settings-section">
                                <div class="setting-group">
                                    <div class="setting-group-header">
                                        <h3>주문 준비시간 설정</h3>
                                        <button class="btn-link" onclick="openPrepTimeSettings()">설정</button>
                                    </div>
                                    <div class="prep-time-list">
                                        <div class="prep-time-item">
                                            <span class="prep-time-label">가게배달 음식준비 + 배달시간</span>
                                            <span class="prep-time-value">최근 시간 사용</span>
                                        </div>
                                        <div class="prep-time-item">
                                            <span class="prep-time-label">얌딜 환전배달 음식 준비시간</span>
                                            <span class="prep-time-value">15~20분</span>
                                        </div>
                                        <div class="prep-time-item">
                                            <span class="prep-time-label">포장 방문 음식 준비시간</span>
                                            <span class="prep-time-value">최근 시간 사용</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="setting-group">
                                    <div class="setting-group-header">
                                        <h3>주문 상세 정보 순서 변경</h3>
                                        <p class="group-description">주문 상세 정보 항목을 드래그 앤 드롭하여 순서를 변경할 수 있습니다.</p>
                                    </div>
                                    <div class="order-info-sequence" id="orderInfoSequence">
                                        <div class="sequence-item" draggable="true">
                                            <i class="fas fa-grip-vertical"></i>
                                            <span>배달현황</span>
                                        </div>
                                        <div class="sequence-item" draggable="true">
                                            <i class="fas fa-grip-vertical"></i>
                                            <span>요청사항</span>
                                        </div>
                                        <div class="sequence-item" draggable="true">
                                            <i class="fas fa-grip-vertical"></i>
                                            <span>배달정보/주문자정보</span>
                                        </div>
                                        <div class="sequence-item" draggable="true">
                                            <i class="fas fa-grip-vertical"></i>
                                            <span>주문정보</span>
                                        </div>
                                        <div class="sequence-item" draggable="true">
                                            <i class="fas fa-grip-vertical"></i>
                                            <span>주문이력</span>
                                        </div>
                                        <div class="sequence-item" draggable="true">
                                            <i class="fas fa-grip-vertical"></i>
                                            <span>가게정보</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-footer">
                        <p>Copyright 2025 yumyumorder. All right reserved. 얌얌 오더는 주식회사 (주)얌얌프랜차이즈에서 제공하는 서비스로 (주)얌얌프랜차이즈의 책임 관리하에 제공됩니다.</p>
                    </div>
                </div>

                <!-- 프린터 설정 -->
                <div id="printer-settings" class="settings-panel">
                    <div class="printer-tab-header">
                        <button class="printer-tab-btn active" data-tab="printer" onclick="switchPrinterTab('printer')">
                            프린터
                        </button>
                        <button class="printer-tab-btn" data-tab="add" onclick="switchPrinterTab('add')">
                            <i class="fas fa-plus"></i> 추가
                        </button>
                        <button class="printer-tab-btn" data-tab="delete" onclick="switchPrinterTab('delete')">
                            삭제
                        </button>
                        <button class="printer-help-btn" onclick="openPrinterHelp()">
                            <i class="fas fa-list"></i> 설정 방법 안내
                        </button>
                    </div>

                    <div class="printer-content">
                        <!-- 왼쪽: 프린터 설정 -->
                        <div class="printer-left-section">
                        <div class="setting-item">
                            <div class="setting-info">
                                    <h3>프린터 사용하기</h3>
                            </div>
                            <label class="toggle-switch">
                                    <input type="checkbox" id="printerEnabled" checked>
                                <span class="slider"></span>
                            </label>
                        </div>

                            <div class="printer-field">
                                <label>프린터명</label>
                                <div class="field-group">
                                    <input type="text" class="input-box" id="printerName" value="프린터" readonly>
                                    <button class="btn-field" onclick="openPrinterNameModal()">변경</button>
                                </div>
                            </div>

                            <div class="printer-field">
                                <label>출력꼬</label>
                                <div class="field-group">
                                    <input type="text" class="input-box" id="printerCopies" value="3출" readonly>
                                    <button class="btn-field" onclick="openCopiesModal()">변경</button>
                                </div>
                            </div>

                            <div class="printer-field">
                                <label>연결포트</label>
                                <div class="field-group">
                                    <input type="text" class="input-box" id="connectionPort" value="선택없음" readonly>
                                    <button class="btn-field" onclick="openPortModal()">변경</button>
                                </div>
                            </div>

                            <div class="printer-field">
                                <label>연결속도</label>
                                <div class="field-group">
                                    <input type="text" class="input-box" id="connectionSpeed" value="9600" readonly>
                                    <button class="btn-field" onclick="openSpeedModal()">변경</button>
                                </div>
                            </div>

                            <div class="printer-test-section">
                                <h3>테스트출력</h3>
                                <p class="test-description">프린터 연결 상태를 확인하고, 출력이 안 되면 연결포트나 속도를 변경해 보세요.</p>
                                <button class="btn-test" onclick="testPrint()">출력</button>
                            </div>
                        </div>

                        <!-- 오른쪽: 자동 출력물 설정 -->
                        <div class="printer-right-section">
                            <div class="auto-print-header">
                                <h3>자동 출력물 설정 <span class="info-text">주문전표(고객용), 주문서(고객용)</span> <i class="fas fa-info-circle"></i></h3>
                                <p class="auto-print-description">주문 유형별 출력 장수를 확인하고 자동 출력을 원치 않으면 스위치를 꺼주세요.</p>
                            </div>

                            <div class="auto-print-item">
                                <div class="auto-print-label">
                                    <span>주문전표</span>
                                    <div class="print-count-control">
                                        <button class="count-btn" onclick="decreasePrintCount('orderReceipt')">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                        <span class="count-display" id="orderReceiptCount">1장</span>
                                        <button class="count-btn" onclick="increasePrintCount('orderReceipt')">
                                            <i class="fas fa-plus"></i>
                            </button>
                        </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="orderReceiptEnabled" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="auto-print-item">
                                <div class="auto-print-label">
                                    <span>주문서</span>
                                    <div class="print-count-control">
                                        <button class="count-btn" onclick="decreasePrintCount('orderSheet')">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                        <span class="count-display" id="orderSheetCount">1장</span>
                                        <button class="count-btn" onclick="increasePrintCount('orderSheet')">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="orderSheetEnabled" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 알림 설정 -->
                <div id="notification-settings" class="settings-panel">
                    <div class="settings-section">
                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>가게 알림설정</h3>
                                <p>가게에서 설정한 소리 및 알림으로 알려드려요</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="storeAlarmEnabled" checked>
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="setting-item volume-control-item" id="volumeControlSection">
                            <div class="setting-info">
                                <h3>알림 볼륨</h3>
                                <p>알림음 크기를 6단계로 조절할 수 있습니다</p>
                            </div>
                            <div class="volume-gauge-container">
                                <div class="volume-gauge">
                                    <div class="gauge-bar" id="volumeGaugeBar"></div>
                                    <div class="gauge-levels">
                                        <button class="gauge-level" data-level="1" onclick="setVolumeLevel(1)">1</button>
                                        <button class="gauge-level" data-level="2" onclick="setVolumeLevel(2)">2</button>
                                        <button class="gauge-level" data-level="3" onclick="setVolumeLevel(3)">3</button>
                                        <button class="gauge-level" data-level="4" onclick="setVolumeLevel(4)">4</button>
                                        <button class="gauge-level" data-level="5" onclick="setVolumeLevel(5)">5</button>
                                        <button class="gauge-level" data-level="6" onclick="setVolumeLevel(6)">6</button>
                                    </div>
                                </div>
                                <div class="volume-label">볼륨: <span id="volumeLevelText">3</span>단계</div>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>자동접수</h3>
                                <p>신규 주문이 들어오면 자동으로 접수합니다</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="autoAcceptEnabled">
                                <span class="slider"></span>
                            </label>
                        </div>

                        <div class="setting-item auto-time-setting" id="autoAcceptTimeSection" style="display: none;">
                            <div class="setting-info">
                                <h3>자동 조리시간 설정</h3>
                                <p>자동 접수 시 설정될 조리시간입니다 (5분 ~ 60분)</p>
                            </div>
                            <div class="time-control-group">
                                <button class="time-control-btn" onclick="decreaseAutoTime()">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <div class="time-display">
                                    <span id="autoAcceptTime">15</span>분
                                </div>
                                <button class="time-control-btn" onclick="increaseAutoTime()">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- 상세 알림 설정 모달 -->
        <div id="detailAlarmModal" class="modal-overlay">
            <div class="modal-container alarm-modal">
                <div class="modal-header">
                    <h3>주문 관리대로 알림</h3>
                    <button class="modal-close" onclick="closeDetailAlarmModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="alarm-section">
                        <div class="alarm-item">
                            <div class="alarm-info">
                                <label>주문 접수 시 알림</label>
                                <p>소리 및 팝업 알림을 고객이 선택한 시간 이내에만 알림을 받습니다</p>
                            </div>
                        </div>

                        <div class="alarm-option">
                            <label>
                                <input type="radio" name="orderAlarm" value="all" checked>
                                <span>전체 시간</span>
                            </label>
                        </div>

                        <div class="alarm-option">
                            <label class="time-option">
                                <input type="radio" name="orderAlarm" value="custom">
                                <span>신규 시간</span>
                            </label>
                            <div class="time-input-group">
                                <button class="time-btn" onclick="decreaseTime('orderTime')">-</button>
                                <input type="text" id="orderTime" value="10" readonly>
                                <span>분 내로</span>
                                <button class="time-btn" onclick="increaseTime('orderTime')">+</button>
                            </div>
                        </div>

                        <div class="alarm-section">
                            <h4>픽업 완료마다 알림시간</h4>
                            <div class="alarm-option">
                                <label>
                                    <input type="radio" name="pickupAlarm" value="all" checked>
                                    <span>전체 시간</span>
                                </label>
                            </div>

                            <div class="alarm-option">
                                <label class="time-option">
                                    <input type="radio" name="pickupAlarm" value="custom">
                                    <span>선결 시간</span>
                                </label>
                                <div class="time-input-group">
                                    <button class="time-btn" onclick="decreaseTime('pickupTime')">-</button>
                                    <input type="text" id="pickupTime" value="10" readonly>
                                    <span>분 후 ~ 15분 이내</span>
                                    <button class="time-btn" onclick="increaseTime('pickupTime')">+</button>
                                </div>
                            </div>
                        </div>

                        <div class="alarm-section">
                            <h4>조리 완료마다 알림시간</h4>
                            <div class="alarm-option">
                                <label>
                                    <input type="checkbox" id="cookingCompleteAlarm">
                                    <span>전체 시간</span>
                                </label>
                            </div>

                            <div class="alarm-option">
                                <label class="time-option">
                                    <input type="checkbox" id="cookingCompleteCustom">
                                    <span>선결 시간</span>
                                </label>
                                <div class="time-input-group">
                                    <button class="time-btn" onclick="decreaseTime('cookingTime')">-</button>
                                    <input type="text" id="cookingTime" value="10" readonly>
                                    <span>분 ~ 15분 이내</span>
                                    <button class="time-btn" onclick="increaseTime('cookingTime')">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-primary full-width" onclick="saveAlarmSettings()">적용</button>
                </div>
            </div>
        </div>

        <!-- 프린터 설정 모달들 -->
        <!-- 연결속도 선택 모달 -->
        <div id="speedModal" class="modal-overlay">
            <div class="modal-container speed-modal">
                <div class="modal-header">
                    <h3>연결속도 선택</h3>
                    <button class="modal-close" onclick="closeSpeedModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p class="modal-description">연결속도를 선택해주세요.</p>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="speed" value="default">
                            <span class="radio-label">사용자 설정</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="9600" checked>
                            <span class="radio-label">9600</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="14400">
                            <span class="radio-label">14400</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="19200">
                            <span class="radio-label">19200</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="38400">
                            <span class="radio-label">38400</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="56000">
                            <span class="radio-label">56000</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="57600">
                            <span class="radio-label">57600</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="115200">
                            <span class="radio-label">115200</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="128000">
                            <span class="radio-label">128000</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="speed" value="256000">
                            <span class="radio-label">256000</span>
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="closeSpeedModal()">취소</button>
                    <button class="btn-confirm" onclick="saveSpeed()">저장</button>
                </div>
            </div>
        </div>

        <!-- 출력꼬 선택 모달 -->
        <div id="copiesModal" class="modal-overlay">
            <div class="modal-container copies-modal">
                <div class="modal-header">
                    <h3>출력꼬 선택</h3>
                    <button class="modal-close" onclick="closeCopiesModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p class="modal-description">출력꼬를 선택해주세요.</p>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="copies" value="0">
                            <span class="radio-label">0출</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="copies" value="1">
                            <span class="radio-label">1출</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="copies" value="2">
                            <span class="radio-label">2출</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="copies" value="3" checked>
                            <span class="radio-label">3출</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="copies" value="4">
                            <span class="radio-label">4출</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="copies" value="5">
                            <span class="radio-label">5출</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="copies" value="6">
                            <span class="radio-label">6출</span>
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="closeCopiesModal()">취소</button>
                    <button class="btn-confirm" onclick="saveCopies()">저장</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Electron API 노출
        if (typeof require !== 'undefined') {
            const { ipcRenderer } = require('electron');
            window.electron = {
                getPrinters: () => ipcRenderer.invoke('get-printers'),
                checkPrinter: (name) => ipcRenderer.invoke('check-printer', name),
                printReceipt: (printer, data) => ipcRenderer.invoke('print-receipt', printer, data),
                closeApp: () => ipcRenderer.send('close-app')
            };
        }
    </script>
    <script src="settings.js"></script>
</body>
</html>

